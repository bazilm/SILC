START
MOV SP,1535
MOV BP,1535
PUSH R0
CALL main
HALT
partition:
PUSH BP
MOV BP,SP
PUSH R0
PUSH R0
MOV R0,BP
MOV R1,1
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,-3
ADD R1,R2
MOV R1,[R1]
POP R2
SUB R1,R2
MOV [R0],R1
WHILEBEG1:
MOV R0,BP
MOV R1,-3
ADD R0,R1
MOV R0,[R0]
MOV R1,BP
MOV R2,-4
ADD R1,R2
MOV R1,[R1]
LT R0,R1
JZ R0,WHILEEND1
MOV R0,BP
MOV R1,-3
ADD R0,R1
MOV R0,[R0]
MOV R1,0
ADD R0,R1
MOV R0,[R0]
MOV R1,BP
MOV R2,-4
ADD R1,R2
MOV R1,[R1]
MOV R2,0
ADD R1,R2
MOV R1,[R1]
LE R0,R1
JZ R0,ELSE1
MOV R0,BP
MOV R1,1
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
POP R2
ADD R1,R2
MOV [R0],R1
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R1,BP
MOV R2,-3
ADD R1,R2
MOV R1,[R1]
MOV R2,0
ADD R1,R2
MOV R1,[R1]
MOV [R0],R1
MOV R0,BP
MOV R1,-3
ADD R0,R1
MOV R0,[R0]
MOV R1,0
ADD R0,R1
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
MOV R2,0
ADD R1,R2
MOV R1,[R1]
MOV [R0],R1
MOV R0,BP
MOV R1,1
ADD R0,R1
MOV R0,[R0]
MOV R1,0
ADD R0,R1
MOV R1,BP
MOV R2,2
ADD R1,R2
MOV R1,[R1]
MOV [R0],R1
JMP ENDIF1
ELSE1:
ENDIF1:
MOV R0,BP
MOV R1,-3
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,-3
ADD R1,R2
MOV R1,[R1]
POP R2
ADD R1,R2
MOV [R0],R1
JMP WHILEBEG1
WHILEEND1:
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
POP R2
ADD R1,R2
MOV R2,0
ADD R1,R2
MOV R1,[R1]
MOV [R0],R1
MOV R0,1
PUSH R0
MOV R0,BP
MOV R1,1
ADD R0,R1
MOV R0,[R0]
POP R1
ADD R0,R1
MOV R1,0
ADD R0,R1
MOV R1,BP
MOV R2,-4
ADD R1,R2
MOV R1,[R1]
MOV R2,0
ADD R1,R2
MOV R1,[R1]
MOV [R0],R1
MOV R0,BP
MOV R1,-4
ADD R0,R1
MOV R0,[R0]
MOV R1,0
ADD R0,R1
MOV R1,BP
MOV R2,2
ADD R1,R2
MOV R1,[R1]
MOV [R0],R1
MOV R0,BP
MOV R1,1
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
POP R2
ADD R1,R2
MOV [R0],R1
MOV R0,BP
MOV R1,-2
ADD R0,R1
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
MOV [R0],R1
POP R2
POP R2
POP BP
RET
quicksort:
PUSH BP
MOV BP,SP
PUSH R0
PUSH R0
MOV R0,BP
MOV R1,-3
ADD R0,R1
MOV R0,[R0]
MOV R1,BP
MOV R2,-4
ADD R1,R2
MOV R1,[R1]
LE R0,R1
JZ R0,ELSE2
MOV R0,BP
MOV R1,1
ADD R0,R1
PUSH R0
MOV R1,BP
MOV R2,-4
ADD R1,R2
MOV R1,[R1]
PUSH R1
MOV R1,BP
MOV R2,-3
ADD R1,R2
MOV R1,[R1]
PUSH R1
MOV R0,0
PUSH R0
CALL partition
POP R1
POP R0
POP R0
POP R0
MOV [R0],R1
JMP ENDIF2
ELSE2:
ENDIF2:
MOV R0,BP
MOV R1,-2
ADD R0,R1
MOV R1,1
MOV [R0],R1
POP R2
POP R2
POP BP
RET
main:
PUSH BP
MOV BP,SP
PUSH R0
PUSH R0
PUSH R0
MOV R0,BP
MOV R1,1
ADD R0,R1
IN R1
MOV [R0],R1
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R1,0
MOV [R0],R1
WHILEBEG2:
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R0,[R0]
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
LT R0,R1
JZ R0,WHILEEND2
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R0,[R0]
MOV R1,0
ADD R0,R1
IN R1
MOV [R0],R1
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,2
ADD R1,R2
MOV R1,[R1]
POP R2
ADD R1,R2
MOV [R0],R1
JMP WHILEBEG2
WHILEEND2:
MOV R0,BP
MOV R1,3
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
POP R2
SUB R1,R2
MOV [R0],R1
MOV R0,BP
MOV R1,2
ADD R0,R1
PUSH R0
MOV R1,BP
MOV R2,3
ADD R1,R2
MOV R1,[R1]
PUSH R1
MOV R1,0
PUSH R1
MOV R0,0
PUSH R0
CALL quicksort
POP R1
out R1
POP R0
POP R0
POP R0
MOV [R0],R1
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R0,[R0]
OUT R0
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R1,0
MOV [R0],R1
WHILEBEG3:
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R0,[R0]
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
LT R0,R1
JZ R0,WHILEEND3
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R0,[R0]
MOV R1,0
ADD R0,R1
MOV R0,[R0]
OUT R0
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R1,1
PUSH R1
MOV R1,BP
MOV R2,2
ADD R1,R2
MOV R1,[R1]
POP R2
ADD R1,R2
MOV [R0],R1
JMP WHILEBEG3
WHILEEND3:
MOV R0,BP
MOV R1,-2
ADD R0,R1
MOV R1,1
MOV [R0],R1
POP R2
POP R2
POP R2
POP BP
RET
