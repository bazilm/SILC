START
MOV SP,1535
MOV BP,1535
JMP MAIN
fact:
PUSH BP
MOV BP,SP
PUSH R0
MOV R0,BP
MOV R1,-3
ADD R0,R1
MOV R0,[R0]
MOV R1,1
EQ R0,R1
JZ R0,ELSE1
MOV R0,BP
MOV R1,-2
ADD R0,R1
MOV R1,1
MOV [R0],R1
JMP ENDIF1
ELSE1:
MOV R2,BP
MOV R3,1
ADD R2,R3
MOV R3,1
PUSH R3
MOV R3,BP
MOV R4,-3
ADD R3,R4
MOV R3,[R3]
POP R4
SUB R3,R4
MOV [R2],R3
MOV R2,BP
MOV R3,-2
ADD R2,R3
PUSH R0
PUSH R1
PUSH R2
MOV R3,BP
MOV R4,1
ADD R3,R4
MOV R3,[R3]
PUSH R3
MOV R0,0
PUSH R0
CALL fact
POP R3
POP R0
POP R2
POP R1
POP R0
PUSH R3
MOV R3,BP
MOV R4,-3
ADD R3,R4
MOV R3,[R3]
POP R4
MUL R3,R4
MOV [R2],R3
ENDIF1:
POP R4
POP BP
RET
main:
PUSH BP
MOV BP,SP
PUSH R0
PUSH R0
MOV R0,BP
MOV R1,1
ADD R0,R1
IN R1
MOV [R0],R1
MOV R0,BP
MOV R1,2
ADD R0,R1
PUSH R0
MOV R1,BP
MOV R2,1
ADD R1,R2
MOV R1,[R1]
PUSH R1
MOV R0,0
PUSH R0
CALL fact
POP R1
POP R0
POP R0
MOV [R0],R1
MOV R0,BP
MOV R1,2
ADD R0,R1
MOV R0,[R0]
OUT R0
MOV R0,BP
MOV R1,-2
ADD R0,R1
MOV R1,1
MOV [R0],R1
POP R2
POP R2
POP BP
RET
MAIN:
PUSH R0
CALL main
HALT